<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íŠ¸ë˜í”½ ë“±ê¸‰ ê²°ê³¼</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        .eco-badge {
            background: #e8f5e9;
            border-radius: 25px;
            padding: 10px 20px;
            display: inline-block;
            color: #2e7d32;
            border: 1px solid #2e7d32;
        }
        .carbon-metric {
            text-align: center;
            margin: 20px 0;
        }
        .carbon-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="row justify-content-center mt-5">
            <div class="col-md-8">
                <h1 class="text-center mb-4">íŠ¸ë˜í”½ ë“±ê¸‰ ê²°ê³¼</h1>
                
                <!-- ë“±ê¸‰ í‘œì‹œ -->
                <div class="mt-4">
                    <h3 id="grade" class="text-center">ë“±ê¸‰: {{ grade }}</h3>
                    <div class="progress mt-4">
                        <div id="gradeBar" class="progress-bar" role="progressbar"></div>
                    </div>
                </div>

                <!-- íƒ„ì†Œ ë°°ì¶œëŸ‰ ì‹œê°í™” -->
                <div class="row mt-5">
                    <div class="col-md-3 carbon-metric">
                        <div class="carbon-icon">â˜•</div>
                        <p>ì»¤í”¼ 2ì” ë¶„ëŸ‰ì˜<br>íƒ„ì†Œ ë°°ì¶œëŸ‰</p>
                    </div>
                    <div class="col-md-3 carbon-metric">
                        <div class="carbon-icon">ğŸš—</div>
                        <p>ìë™ì°¨ 2km ì£¼í–‰<br>ë°°ì¶œëŸ‰ê³¼ ë™ì¼</p>
                    </div>
                    <div class="col-md-3 carbon-metric">
                        <div class="carbon-icon">ğŸ“±</div>
                        <p>ìŠ¤ë§ˆíŠ¸í° 4ì‹œê°„<br>ì¶©ì „ëŸ‰ê³¼ ë™ì¼</p>
                    </div>
                    <div class="col-md-3 carbon-metric">
                        <div class="carbon-icon">ğŸŒ³</div>
                        <p>ë‚˜ë¬´ 1ê·¸ë£¨ì˜<br>2ì¼ í¡ìˆ˜ëŸ‰</p>
                    </div>
                </div>
                <svg width="800" height="500"></svg>
                <!-- ì§€ì†ê°€ëŠ¥í•œ ì›¹ê°œë°œ ê°€ì´ë“œë¼ì¸ -->
                <div class="mt-5">
                    <h4>ì§€ì†ê°€ëŠ¥í•œ ì›¹ê°œë°œ ê°€ì´ë“œë¼ì¸ ì¤€ìˆ˜ í˜„í™©</h4>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ë²ˆí˜¸</th>
                                <th>í•­ëª©</th>
                                <th>ì¤€ìˆ˜ì—¬ë¶€</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>ì´ë¯¸ì§€ ìµœì í™”</td>
                                <td>âœ…</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>ìºì‹œ í™œìš©</td>
                                <td>âŒ</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>ë¶ˆí•„ìš”í•œ ìŠ¤í¬ë¦½íŠ¸ ì œê±°</td>
                                <td>âœ…</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- ì—ì½”ì›¹ ë±ƒì§€ -->
                <div class="text-center mt-5">
                    <div class="eco-badge">
                        <span>125g of CO2</span>
                        <span>ECO-WEB</span>
                    </div>
                </div>

                <!-- ë¦¬ì†ŒìŠ¤ ì ˆê° í˜„í™© -->
                <div class="mt-5">
                    <h4>ìµœì í™” ì „/í›„ ë¹„êµ</h4>
                    <div class="row">
                        <div class="col-md-6">
                            <h5>Before</h5>
                            <img src="{{ url_for('static', filename='screenshots/before.png') }}" alt="Before" class="image">
                            <p>ì´ ë¦¬ì†ŒìŠ¤: 3.3MB</p>
                        </div>
                        <div class="col-md-6">
                            <h5>After</h5>
                            <img src="{{ url_for('static', filename='screenshots/after.png') }}" alt="After" class="image">
                            <p>ì´ ë¦¬ì†ŒìŠ¤: 1.1MB</p>
                        </div>
                    </div>
                </div>
                <!-- ì¸ì¦ë§ˆí¬ ë°›ê¸° -->
                <div class="text-center mt-4">
                    <a href="/" class="btn btn-secondary">ë‹¤ì‹œ ì…ë ¥í•˜ê¸°</a>
                </div>
            </div>
        </div>
    </div>


    <script>
        // ê¸°ì¡´ ë“±ê¸‰ í‘œì‹œ ìŠ¤í¬ë¦½íŠ¸
        const grade = "{{ grade }}";
        const grades = ['A', 'B', 'C', 'D', 'E', 'F'];
        const gradeBar = document.getElementById('gradeBar');
        gradeBar.style.width = (grades.indexOf(grade) + 1) * 16.66 + '%';
        gradeBar.textContent = grade;

        switch (grade) {
            case 'A': gradeBar.classList.add('bg-success'); break;
            case 'B': gradeBar.classList.add('bg-info'); break;
            case 'C': gradeBar.classList.add('bg-primary'); break;
            case 'D': gradeBar.classList.add('bg-warning'); break;
            case 'E': gradeBar.classList.add('bg-orange'); break;
            case 'F': gradeBar.classList.add('bg-danger'); break;
        }

// ì˜ˆì‹œ ë°ì´í„° ìƒì„± (íŒŒì´ì¬ì—ì„œ ë§Œë“  ë°ì´í„°ì™€ ìœ ì‚¬í•˜ê²Œ)
const existingData = Array.from({length: 25000}, () => d3.randomNormal(500, 100)());

// ìƒˆë¡œìš´ URL ë°ì´í„°
const newUrlData = 550;

// SVG í¬ê¸° ì„¤ì •
const svg = d3.select("svg");
const margin = {top: 20, right: 20, bottom: 30, left: 40};
const width = +svg.attr("width") - margin.left - margin.right;
const height = +svg.attr("height") - margin.top - margin.bottom;
const g = svg.append("g").attr("transform", `translate(${margin.left},${margin.top})`);

// Xì¶• ë° Yì¶• ë²”ìœ„ ì„¤ì •
const x = d3.scaleLinear()
    .domain([d3.min(existingData), d3.max(existingData)])
    .rangeRound([0, width]);

const bins = d3.histogram()
    .domain(x.domain())
    .thresholds(x.ticks(50))
    (existingData);

const y = d3.scaleLinear()
    .domain([0, d3.max(bins, d => d.length)])
    .range([height, 0]);

// Xì¶•
g.append("g")
    .attr("class", "axis axis--x")
    .attr("transform", `translate(0,${height})`)
    .call(d3.axisBottom(x));

// Yì¶•
g.append("g")
    .attr("class", "axis axis--y")
    .call(d3.axisLeft(y));

// íˆìŠ¤í† ê·¸ë¨ ë§‰ëŒ€ ì¶”ê°€
g.selectAll(".bar")
    .data(bins)
    .enter().append("rect")
    .attr("class", "bar")
    .attr("x", d => x(d.x0))
    .attr("y", d => y(d.length))
    .attr("width", d => x(d.x1) - x(d.x0) - 1)
    .attr("height", d => height - y(d.length))
    .attr("fill", "steelblue");

// ìƒˆë¡œìš´ URL ë°ì´í„°ë¥¼ ì„ ìœ¼ë¡œ í‘œì‹œ
g.append("line")
    .attr("x1", x(newUrlData))
    .attr("x2", x(newUrlData))
    .attr("y1", 0)
    .attr("y2", height)
    .attr("stroke", "red")
    .attr("stroke-width", 2)
    .attr("stroke-dasharray", "4,4");

    </script>
</body>
</html>